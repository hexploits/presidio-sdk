package com.hexploits.oss.sdk.presidio.anonymizer.strategy;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertThrows;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

class EncryptAnonymizerStrategyTest {

    @ParameterizedTest
    @ValueSource(strings = {"1234567890123456", "123456789012345678901234", "12345678901234567890123456789012"})
    void testValidKeyLengths(String key) {
        EncryptAnonymizerStrategy strategy = new EncryptAnonymizerStrategy(key);
        assertEquals("encrypt", strategy.getType());
        assertEquals(key, strategy.getKey());
    }

    @ParameterizedTest
    @ValueSource(strings = {"12345", "", "null"})
    void testInvalidKeyLengths(String key) {
        String actualKey = "null".equals(key) ? null : key;
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () ->
          new EncryptAnonymizerStrategy(actualKey)
        );
        assertEquals("Invalid key length, should be 16, 24 or 32.", exception.getMessage());
    }
}