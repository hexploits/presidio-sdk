package com.hexploits.oss.sdk.presidio.anonymizer.deanonymize;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertThrows;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.NullAndEmptySource;
import org.junit.jupiter.params.provider.ValueSource;

class DecryptAnonymizerTest {

    @ParameterizedTest
    @ValueSource(strings = {"1234567890123456", "123456789012345678901234", "12345678901234567890123456789012"})
    void testValidKeyLengths(String key) {
        DecryptAnonymizer decryptAnonymizer = new DecryptAnonymizer(key);
        assertEquals("decrypt", decryptAnonymizer.getType());
        assertEquals(key, decryptAnonymizer.getKey());
    }

    @ParameterizedTest
    @NullAndEmptySource
    @ValueSource(strings = {"12345"})
    void testInvalidKeyLengths(String key) {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
            new DecryptAnonymizer(key);
        });
        assertEquals("Invalid key length, should be 16, 24 or 32.", exception.getMessage());
    }
}