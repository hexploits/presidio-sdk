package com.hexploits.oss.sdk.presidio.anonymizer.strategy;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertThrows;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

class HashAnonymizerStrategyTest {

    @ParameterizedTest
    @ValueSource(strings = {"md5", "sha256", "sha512"})
    void testValidHashTypes(String hashType) {
        HashAnonymizerStrategy strategy = new HashAnonymizerStrategy(hashType);
        assertEquals("hash", strategy.getType());
        assertEquals(hashType, strategy.getHashType());
    }

    @ParameterizedTest
    @ValueSource(strings = {"", "null", "sha1", "sha-256"})
    void testInvalidHashTypes(String hashType) {
        String actualHashType = "null".equals(hashType) ? null : hashType;
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () ->
          new HashAnonymizerStrategy(actualHashType)
        );
        assertEquals("Invalid hashType. Must be one of: md5, sha256, sha512", exception.getMessage());
    }
}