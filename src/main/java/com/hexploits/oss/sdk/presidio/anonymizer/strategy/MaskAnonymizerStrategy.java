package com.hexploits.oss.sdk.presidio.anonymizer.strategy;

import com.fasterxml.jackson.databind.PropertyNamingStrategies;
import com.fasterxml.jackson.databind.annotation.JsonNaming;

@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)
public class MaskAnonymizerStrategy implements AnonymizerStrategy {

    private final String type = "mask";

    // The replacement character
    private final String maskingChar;

    // The amount of characters that should be replaced
    private final int charsToMask;

    // Whether to mask the PII from its end
    private final boolean fromEnd;

    public MaskAnonymizerStrategy(String maskingChar, int charsToMask, boolean fromEnd) {
        if (charsToMask < 0) {
            throw new IllegalArgumentException("charsToMask cannot be negative");
        }

        this.maskingChar = maskingChar;
        this.charsToMask = charsToMask;
        this.fromEnd = fromEnd;
    }

    public String getType() {
        return type;
    }

    public String getMaskingChar() {
        return maskingChar;
    }

    public int getCharsToMask() {
        return charsToMask;
    }

    public boolean isFromEnd() {
        return fromEnd;
    }
}
