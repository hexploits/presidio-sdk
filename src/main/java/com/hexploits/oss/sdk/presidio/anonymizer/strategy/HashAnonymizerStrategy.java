package com.hexploits.oss.sdk.presidio.anonymizer.strategy;

import com.fasterxml.jackson.databind.PropertyNamingStrategies;
import com.fasterxml.jackson.databind.annotation.JsonNaming;

@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)
public class HashAnonymizerStrategy implements AnonymizerStrategy {

    private final String type = "hash";
    // md5, sha256, sha512
    private final String hashType;

    public HashAnonymizerStrategy(String hashType) {
        if (hashType == null || hashType.isEmpty() ||
            !(hashType.equals("md5") || hashType.equals("sha256") || hashType.equals("sha512"))) {
            throw new IllegalArgumentException("Invalid hashType. Must be one of: md5, sha256, sha512");
        }

        this.hashType = hashType;
    }

    @Override
    public String getType() {
        return type;
    }

    public String getHashType() {
        return hashType;
    }
}
